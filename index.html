<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cek Hasil KBIJ | WOM Finance</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // Menonaktifkan Klik Kanan
      document.addEventListener("contextmenu", function (e) {
        e.preventDefault();
      });

      // Menonaktifkan F12 dan Inspect Element
      document.addEventListener("keydown", function (e) {
        if (e.key === "F12" || (e.ctrlKey && e.shiftKey && e.key === "I")) {
          e.preventDefault();
        }
      });
    </script>
  </head>
  <body class="bg-light">
    <div class="container py-3">
      <h1 class="mb-4 text-center">Cek Hasil KBIJ - WOM Finance</h1>
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0 small">Silahkan Isi Form Dibawah Dengan Benar!</h5>
        </div>
        <div class="card-body">
          <h5 class="card-title">Request By</h5>
          <form id="faqForm" method="POST" novalidate>
            <!-- Brand and Region -->
            <div class="row mb-2">
              <div class="col-md-6">
                <label for="brand" class="form-label small text-muted"
                  >Brand</label
                >
                <select
                  id="brand"
                  name="entry.69261723"
                  class="form-select form-select-sm"
                  required
                >
                  <option value="">-- Pilih Brand --</option>
                  <option value="Reguler">Reguler</option>
                  <option value="MasKu">MasKu</option>
                  <option value="MotorKu">MotorKu</option>
                  <option value="MobilKu">MobilKu</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="region" class="form-label small text-muted"
                  >Region</label
                >
                <select
                  id="region"
                  name="entry.545173778"
                  class="form-select form-select-sm"
                >
                  <option value="">-- Pilih Region --</option>
                  <!-- Region options will be added dynamically -->
                </select>
              </div>
            </div>

            <!-- Cabang and NIK -->
            <div class="row mb-2">
              <div class="col-md-6">
                <label for="cabang" class="form-label small text-muted"
                  >Cabang</label
                >
                <select
                  id="cabang"
                  name="entry.95778692"
                  class="form-select form-select-sm"
                >
                  <option value="">-- Pilih Cabang --</option>
                  <!-- Cabang options will be added dynamically -->
                </select>
              </div>
              <div class="col-md-6">
                <label for="nik" class="form-label small text-muted"
                  >NIK Karyawan</label
                >
                <input
                  type="number"
                  id="nik"
                  name="entry.741332940"
                  class="form-control form-control-sm"
                />
              </div>
            </div>

            <!-- Nama -->
            <div class="row mb-2">
              <div class="col-md-12">
                <label for="nama" class="form-label small text-muted"
                  >Nama</label
                >
                <input
                  type="text"
                  id="nama"
                  name="entry.2094592601"
                  class="form-control form-control-sm"
                />
              </div>
            </div>
            <h5 class="card-title mt-4">Data Pemohon</h5>
            <!-- Nama Cust and NIK KTP -->
            <div class="row mb-4">
              <div class="col-md-6">
                <label for="nikC" class="form-label small text-muted"
                  >NIK KTP</label
                >
                <input
                  type="number"
                  id="nikC"
                  name="entry.1551384863"
                  class="form-control form-control-sm"
                />
              </div>
              <div class="col-md-6">
                <label for="NCust" class="form-label small text-muted"
                  >Nama Cust</label
                >
                <input
                  type="text"
                  id="NCust"
                  name="entry.686554731"
                  class="form-control form-control-sm"
                />
              </div>
            </div>

            <!-- Buttons -->
            <div class="mb-2">
              <button
                type="submit"
                id="submitButton"
                class="btn btn-primary btn-sm"
              >
                Submit
              </button>
              <button
                type="button"
                class="btn btn-secondary btn-sm"
                onclick="window.location.reload()"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script>
      // Elements
      const regionSelect = document.getElementById("region");
      const cabangSelect = document.getElementById("cabang");

      // Fetch data from output.json
      fetch("output.json")
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          // Populate Region options dynamically
          const regions = [...new Set(data.map((item) => item.Region))];
          regions.forEach((region) => {
            const option = document.createElement("option");
            option.value = region;
            option.textContent = region;
            regionSelect.appendChild(option);
          });

          // Handle Region selection change
          regionSelect.addEventListener("change", function () {
            const selectedRegion = this.value;

            // Clear previous Cabang options
            cabangSelect.innerHTML =
              '<option value="">-- Pilih Cabang --</option>';

            // Filter Cabang options based on selected Region
            const filteredCabang = data.filter(
              (item) => item.Region === selectedRegion
            );
            filteredCabang.forEach((item) => {
              const option = document.createElement("option");
              option.value = item.Cabang;
              option.textContent = item.Cabang;
              cabangSelect.appendChild(option);
            });
          });
        })
        .catch((error) => {
          console.error("Error fetching JSON:", error);
        });

      // Event listener untuk validasi saat form disubmit
      document
        .getElementById("faqForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const form = document.getElementById("faqForm");
          form.action =
            "https://docs.google.com/forms/d/e/1FAIpQLSf1ZnqQprAIKQw-yaQTuILKBh7G8ZCReRGTdKfym50uE9xSfw/formResponse";
          form.method = "POST";
          // form.submit();
          // Menggunakan fetch untuk mengirim data ke Google Forms
          fetch(form.action, {
            method: "POST",
            body: new FormData(form),
            mode: "no-cors", // CORS tidak diperiksa
          })
            .then(() => {
              // Menunggu untuk pengiriman berhasil
              setTimeout(function () {
                Swal.fire("Berhasil!", "Formulir berhasil dikirim.", "success");
                form.reset(); // Reset formulir
              }, 1000); // Waktu tunggu untuk simulasi
            })
            .catch(() => {
              // Jika gagal mengirim data
              Swal.fire("Gagal!", "Pengiriman formulir gagal.", "error");
            });
        });
    </script>
  </body>
</html>
