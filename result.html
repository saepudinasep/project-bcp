<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cek Hasil KBIJ | WOM Finance</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
  </head>
  <body class="bg-light">
    <div class="container py-3">
      <h1 class="mb-4 text-center">Result Cek Hasil KBIJ - WOM Finance</h1>
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0 small">Cari Berdasarkan yang ingin anda cari!</h5>
        </div>
        <div class="card-body">
          <form id="searchForm">
            <div class="row g-3">
              <div class="col-md-3">
                <label for="searchKendala" class="form-label">NIK KTP</label>
                <input
                  type="text"
                  id="searchKendala"
                  class="form-control"
                  placeholder="Cari NIK KTP"
                />
              </div>
            </div>
            <div class="mt-3 text-end">
              <button
                type="button"
                id="clearBtn"
                class="btn btn-secondary me-2"
              >
                Clear
              </button>
              <button type="button" id="searchBtn" class="btn btn-primary">
                Cari
              </button>
            </div>
          </form>
          <table class="table">
            <thead>
              <tr>
                <th scope="col">No</th>
                <th scope="col">NIK KTP</th>
                <th scope="col">Nama Customer</th>
                <th scope="col">Result KBIJ</th>
              </tr>
            </thead>
            <tbody>
              <!-- <tr>
                <th scope="row">1</th>
                <td>3209011112010006</td>
                <td>Asep Saepudin</td>
                <td>Yes</td>
              </tr> -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <script>
      // Ganti dengan ID Spreadsheet dan API Key yang valid
      const SHEET_ID = "YOUR_SHEET_ID";
      const API_KEY = "YOUR_API_KEY";

      // Event listener untuk mencari data berdasarkan NIK KTP
      document
        .getElementById("searchBtn")
        .addEventListener("click", function () {
          const nikKTP = document.getElementById("searchKendala").value;
          if (!nikKTP) {
            alert("Masukkan NIK KTP untuk mencari!");
            return;
          }

          // Fetch data dari Google Sheets API
          fetch(
            `https://docs.google.com/spreadsheets/d/18QsVrrzmV1lNzjISxoRX16nP9aWMSI8B0B_DoKni9xg/edit?resourcekey=&gid=923230873#gid=923230873`
          )
            .then((response) => response.json())
            .then((data) => {
              const rows = data.values;
              const result = rows.filter((row) => row[1] === nikKTP); // Kolom 1 adalah NIK KTP

              const resultBody = document.getElementById("resultBody");
              resultBody.innerHTML = ""; // Kosongkan hasil sebelumnya

              if (result.length > 0) {
                result.forEach((row, index) => {
                  const tr = document.createElement("tr");
                  tr.innerHTML = `
                  <th scope="row">${index + 1}</th>
                  <td>${row[1]}</td> <!-- NIK KTP -->
                  <td>${row[2]}</td> <!-- Nama Customer -->
                  <td>${row[3]}</td> <!-- Result KBIJ -->
                `;
                  resultBody.appendChild(tr);
                });
              } else {
                resultBody.innerHTML = `<tr><td colspan="4" class="text-center">Data tidak ditemukan</td></tr>`;
              }
            })
            .catch((error) => {
              console.error("Error fetching data:", error);
              alert("Terjadi kesalahan saat mengambil data.");
            });
        });

      // Event listener untuk tombol clear
      document
        .getElementById("clearBtn")
        .addEventListener("click", function () {
          document.getElementById("searchKendala").value = "";
          document.getElementById("resultBody").innerHTML = "";
        });
    </script>
  </body>
</html>
